<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:fragment="head">
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>phongtromoi</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/animate.css/animate.min.css" th:href="@{/assets/vendor/animate.css/animate.min.css}" rel="stylesheet">
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" th:href="@{/assets/vendor/bootstrap/css/bootstrap.min.css}" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" th:href="@{/assets/vendor/bootstrap-icons/bootstrap-icons.css}" rel="stylesheet">
    <link href="assets/vendor/swiper/swiper-bundle.min.css" th:href="@{/assets/vendor/swiper/swiper-bundle.min.css}" rel="stylesheet">

    <!-- Template Main CSS File -->
    <link href="assets/css/style.css" th:href="@{/assets/css/style.css}" rel="stylesheet">
    <!--    link jquery-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js">
    </script>
</head>
<body>
<div th:fragment="header">
    <div class="click-closed"></div>
    <!--/ Form Search Star /-->
    <div class="box-collapse">
        <div class="title-box-d">
            <h3 class="title-d">Tìm kiếm</h3>
        </div>
        <span class="close-box-collapse right-boxed bi bi-x"></span>
        <div class="box-collapse-wrap form">
            <form class="form-a" th:action="@{/api/search}" th:method="post">
                <div class="row">
                    <div class="col-md-6 mb-2">
                        <div class="form-group mt-3">
                            <label class="pb-2" for="Type">Loại</label>
                            <select class="form-control form-select form-control-a type" id="Type" name="type">
                                <option value="0">Tất cả</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6 mb-2">
                        <div class="form-group mt-3">
                            <label class="pb-2" for="distric">Quận</label>
                            <select class="form-control form-select form-control-a distric" name="distric" id="distric" onchange="getward()">
                                <option value="0">Tất cả</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6 mb-2">
                        <div class="form-group mt-3">
                            <label class="pb-2" for="ward">Phường</label>
                            <select class="form-control form-select form-control-a ward" id="ward" name="ward">
                                <option value="0"></option>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-6 mb-2">
                        <div class="form-group mt-3">
                            <label class="pb-2" >Diện tích</label>
                            Từ :
                            <input type="text" class="form-control startArea"
                                   placeholder="m2" name="startArea" value="0">
                            Đến :
                            <input type="text" class="form-control endArea"
                                   placeholder="m2" name="endArea" value="0">
                        </div>
                    </div>
                    <div class="col-md-6 mb-2">
                        <div class="form-group mt-3">
                            <label class="pb-2" >Giá</label>
                            Từ :
                            <input type="text" class="form-control startPrice "
                                   placeholder="VND" name="startPrice" value="0">
                            Đến :
                            <input type="text" class="form-control endPrice"
                                   placeholder="VND" name="endPrice" value="0">
                        </div>
                    </div>

                    <div class="col-md-12">
                        <button type="submit" class="btn btn-b" onclick="search()">Tìm kiếm</button>
                    </div>
                </div>
            </form>
        </div>
    </div><!-- End Property Search Section -->>

    <!-- ======= Header/Navbar ======= -->

    <nav class="navbar navbar-default navbar-trans navbar-expand-lg fixed-top">
        <!-- <nav class="navbar navbar-default navbar-trans navbar-expand-lg "> -->

        <div class="container">

            <a class="navbar-brand text-brand" th:href="@{/}">Phongtro<span class="color-b">moi</span>
                <p style="color: black ;font-size: 12px;">Trang thông tin phòng trọ uy tín số 1 Việt Nam </p>
            </a>

            <div class="navbar-collapse collapse justify-content-center" id="navbarDefault">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" href="/">Tìm trọ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="property-grid.html">Cho thuê</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link " href="blog-grid.html">Chung cư</a>
                    </li>

                    <!--                    <li class="nav-item dropdown">-->
                    <!--                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"-->
                    <!--                           data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Pages</a>-->
                    <!--                        <div class="dropdown-menu">-->
                    <!--                            <a class="dropdown-item " href="property-single.html">Property Single</a>-->
                    <!--                            <a class="dropdown-item " href="blog-single.html">Blog Single</a>-->
                    <!--                            <a class="dropdown-item " href="agents-grid.html">Agents Grid</a>-->
                    <!--                            <a class="dropdown-item " href="agent-single.html">Agent Single</a>-->
                    <!--                        </div>-->
                    <!--                    </li>-->
                    <li class="nav-item">
                        <a class="nav-link " href="contact.html">Phòng trọ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="contact.html">Nhà nguyên căn</a>
                    </li>
                </ul>
            </div>

            <button type="button" class="btn btn-b-n navbar-toggle-box navbar-toggle-box-collapse"
                    data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo01">
                <i class="bi bi-search"></i>
            </button>
            <div class="account" th:if="${#httpServletRequest.remoteUser}">
                <p class="username" th:text="${#httpServletRequest.remoteUser}"></p>
                <div class="dropdown">
                    <button class="dropbtn">Quản lý tài khoảng</button>
                    <div class="dropdown-content">
                        <a href="#">Thông tin cá nhân</a>
                        <a href="#">Quản lý tin đăng</a>
                        <a href="/logout">Thoát</a>
                    </div>
                </div>
                <button class="btn-dangbai">Đăng bài</button>
            </div>

            <button  th:unless="${#httpServletRequest.remoteUser}" class="btn-login">Đăng nhập</button>
            <button  th:unless="${#httpServletRequest.remoteUser}" class="btn-register">Đăng kí</button>



        </div>

    </nav><!-- End Header/Navbar -->
    <!-- Vendor JS Files -->
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js" th:src="@{/assets/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>
    <script src="assets/vendor/swiper/swiper-bundle.min.js" th:src="@{/assets/vendor/swiper/swiper-bundle.min.js}"></script>
    <script src="assets/vendor/php-email-form/validate.js" th:src="@{/assets/vendor/php-email-form/validate.js}"></script>
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script src="/assets/js/main.js" th:src="@{/assets/js/main.js}"></script>
    <script>
        $(".btn-login").click(function (){
            window.location.href = "http://localhost:8080/login" ;
        })
        $(".btn-register").click(function (){
            window.location.href = "http://localhost:8080/login" ;
        })
        fetch('http://localhost:8080/api/roomtypes',{
            method: 'GET',
            headers : {
                'Content-Type': 'application/json',
                'Accept': 'application/json'
            }
        })
            .then (res => res.json())
            .then(data => {
                    for(type of data){
                        $("#Type").append("<option value=" + type.id + ">" + type.name  +"</option>")
                    }
                }
            )
        fetch('http://localhost:8080/api/districs',{
            method: 'GET',
            headers : {
                'Content-Type': 'application/json',
                'Accept': 'application/json'
            }
        })
            .then (res => res.json())
            .then(data => {
                    for(distric of data){
                        $("#distric").append("<option value=" + distric.id + ">" + distric.prefix + " " + distric.name  +"</option>")
                    }
                }
            )
        function getward() {
            $(".ward").remove();
            var districid = document.getElementById("distric").value ;
            fetch('http://localhost:8080/api/wards/'+districid,{
                method: 'GET',
                headers : {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                }
            })
                .then (res => res.json())
                .then(data => {
                        for(ward of data)
                            $("#ward").append("<option class='ward' value=" + ward.id + ">" + ward.prefix + " " + ward.name  +"</option>")
                    }
                )
        }
    </script>
</div>
</body>
</html>